/*! @name videojs-livesim @version 0.0.0 @license UNLICENSED */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],o):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsLivesim=o(e.videojs)}(this,(function(e){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=o(e),t={},i=n.default.registerPlugin||n.default.plugin,a=1,r=2,l=3,s={},d=0,c=0,u=0,v=new Date,f=0;function p(e,o){if(!("preLive"in s)||!("showCountdown"in s.preLive)||"preLive"in s&&"showCountdown"in s.preLive&&!s.preLive.showCountdown)console.log("showCountdown disabled");else{var n=document.createElement("div");n.className="vjs-countdown-overlay";var t=document.createElement("div");t.className="vjs-countdown-label";var i=document.createElement("div");if(i.className="vjs-countdown-value","message"in s.preLive){t.innerHTML=s.preLive.message;var a=setInterval((function(){--o<=0?(clearInterval(a),e.el().removeChild(e.el().lastChild),L(e)):i.innerHTML=function(e){e=Number(e);var o=Math.floor(e/86400),n=Math.floor(e%86400/3600),t=Math.floor(e%3600/60),i=Math.floor(e%60);return(o>0?o+(1==o?"  day  ":"  days  "):"")+(o>0||n>0?n+(1==n?"  hour  ":"  hours  "):"")+(o+n>0||t>0?t+(1==t?"  minute  ":"  minutes  "):"")+(o+n+t>0||i>=0?i+(1==i?"  second":"  seconds"):"")}(o)}),1e3)}else console.log("No preLive message provided."),t.innerHTML="The performance will go live in the future.";n.appendChild(t),n.appendChild(i),e.el().appendChild(n)}}function m(e){e.addClass("vjs-live"),h(e,!1),e.controlBar?(e.controlBar.playToggle.hide(),e.controlBar.progressControl.hide()):console.log("Player does not have expected controlBar.")}function g(e,o){void 0===o&&(o=!1);var n=o?"":"none";e.el_.style.pointerEvents=n}function h(e,o){void 0===o&&(o=!1);var n=o?"":"none";e.el_.firstChild.style.pointerEvents=n}function T(e,o){void 0===o&&(o=!1),o?e.bigPlayButton.show():e.bigPlayButton.hide()}function y(e,o){if(e.liveTracker){var n=e.liveTracker.pastSeekEnd_;e.currentTime(o+n)}else console.log("Player does not have expected liveTracker component."),e.currentTime(o)}function L(e){e.duration(1/0);var o=(v-c)/1e3;g(e,!0),T(e,!0),y(e,o),m(e),e.on("play",(function(){2==d&&(y(e,o),e.liveTracker.stopTracking(),m(e),T(e,!1))})),e.on("ended",(function(){2==d&&function(e){d=3,console.log("Stream ended! Resetting for VOD"),e.load()}(e)})),e.play()}var w=function(e){var o=this;!function(e){"object"==typeof e?(s.preLive=e.preLive,s.featureTag=e.featureTag,s.postLive=e.postLive):console.log("Options object is not a proper Javscript object {} (JSON).")}(e),this.ready((function(){var i,m=o;i=m,n.default.mergeOptions(t,e),i.addClass("vjs-livesim"),m.on("loadstart",(function(){var e,o,n,t=m.mediainfo||{};h(m,!1),g(m,!1),T(m,!1),t.tags&&t.tags.includes(s.featureTag)?(f=t.duration||0,c=new Date(t.customFields&&(t.customFields.premiere_time||"")),u=new Date(c.getTime()+1e3*f),n=u,(e=c)>(o=v)?d=a:e<=o&&n>o?d=r:n<=o?d=l:console.log("Invalid Date set for endTime",n)):console.log("livesim not enabled")})),m.on("loadedmetadata",(function(){!function(e,o){switch(o){case 1:console.log("Stream State: PRE"),h(e,!1),g(e,!1),T(e,!1),p(e,(c-v.getTime())/1e3);break;case 2:console.log("Stream State: LIVE"),L(e);break;case 3:console.log("Stream State: POST"),h(e,!0),g(e,!0),T(e,!0);break;default:console.log("Stream State: DISABLED")}}(m,d)}))}))};return i("livesim",w),w.VERSION="0.0.0",w}));
