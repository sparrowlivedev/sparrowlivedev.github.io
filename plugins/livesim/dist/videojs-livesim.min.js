/*! @name videojs-livesim @version 0.0.0 @license UNLICENSED */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],o):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsLivesim=o(e.videojs)}(this,(function(e){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=o(e),t={},a=n.default.registerPlugin||n.default.plugin,i=1,l=2,s=3,r={},d=!1,c=0,u=0,v=0,m=new Date,p=0;function g(e,o){if(!("preLive"in r)||!("showCountdown"in r.preLive)||"preLive"in r&&"showCountdown"in r.preLive&&!r.preLive.showCountdown)console.log("showCountdown disabled");else{var n=document.createElement("div");n.className="vjs-countdown-overlay";var t=document.createElement("div");t.className="vjs-countdown-label";var a=document.createElement("div");a.className="vjs-countdown-value","message"in r.preLive?(t.innerHTML=r.preLive.message,a.innerHTML=function(e){e=Number(e);var o=Math.floor(e/86400),n=Math.floor(e%86400/3600),t=Math.floor(e%3600/60),a=Math.floor(e%60);return(o>0?o+(1==o?" day, ":" days, "):"")+(n>0?n+(1==n?" hour, ":" hours, "):"")+(t>0?t+(1==t?" minute, ":" minutes, "):"")+(a>0?a+(1==a?" second":" seconds"):"")}(o)):(console.log("No preLive message provided."),t.innerHTML="The performance will go live in the future."),n.appendChild(t),n.appendChild(a),e.el().appendChild(n)}}function f(e,o){void 0===o&&(o=!1);var n=o?"":"none";e.el_.firstChild.style.pointerEvents=n,e.el_.style.pointerEvents=n,console.log("toggleClickToPause",e.el_)}function h(e,o){void 0===o&&(o=!1),o?e.bigPlayButton.show():e.bigPlayButton.hide()}var T=function(e){var o=this;!function(e){"object"==typeof e?(r.preLive=e.preLive,r.featureTag=e.featureTag,r.postLive=e.postLive):console.log("Options object is not a proper Javscript object {} (JSON).")}(e),console.log(r),this.ready((function(){var a,T=o;console.log("player ready!",T),a=T,n.default.mergeOptions(t,e),a.addClass("vjs-livesim"),T.on("loadstart",(function(){console.log("loadstart! mediainfo: ",T.mediainfo);var e,o,n,t=T.mediainfo||{};f(T,!1),h(T,!1),d=t.tags&&t.tags.includes(r.featureTag),console.log("_livesimEnabled",d),d?(p=t.duration||0,u=new Date(t.customFields&&(t.customFields.premiere_time||"")),v=new Date(u.getTime()+1e3*p),console.log("_streamDuration",p),console.log("_streamStart",u),console.log("_streamEnd",v),n=v,(e=u)>(o=m)?c=i:e<=o&&n>o?c=l:n<=o?c=s:console.log("Invalid Date set for endTime",n)):console.log("livesim not enabled")})),T.on("loadedmetadata",(function(){switch(c){case 1:console.log("Stream State: PRE"),f(T,!1),h(T,!1);var e=(u.getTime()-m.getTime())/1e3;g(T,e);break;case 2:console.log("Stream State: LIVE"),pageloadVideoTime=Math.floor((m-u)/1e3),console.log("pageloadVideoTime",pageloadVideoTime),function(e){console.log("SHOW LIVE CONTROLS"),e.duration(1/0),e.addClass("vjs-live"),f(e,!1),e.controlBar?(e.controlBar.playToggle.hide(),e.controlBar.progressControl.hide()):console.log("Player does not have expected controlBar.")}(T),function(e,o){if(e.liveTracker){var n=e.liveTracker.pastSeekEnd_;console.log("Update player timestamp: ",o+n),e.currentTime(o+n)}else console.log("Player does not have expected liveTracker component."),e.currentTime(o)}(T,pageloadVideoTime),h(T,!0),T.play();break;case 3:console.log("Stream State: POST");break;default:console.log("Stream State: DISABLED")}}))}))};return a("livesim",T),T.VERSION="0.0.0",T}));
