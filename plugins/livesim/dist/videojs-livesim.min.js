/*! @name videojs-livesim @version 0.0.0 @license UNLICENSED */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],o):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsLivesim=o(e.videojs)}(this,(function(e){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=o(e),n={},a=t.default.registerPlugin||t.default.plugin,i=1,l=2,s=3,r={},c=!1,d=0,f=0,u=0,v=new Date,p=0,g=0;var m=function(e){var o=this;!function(e){"object"==typeof e?(r.preLive=e.preLive,r.featureTag=e.featureTag,r.postLive=e.postLive):console.log("Options object is not a proper Javscript object {} (JSON).")}(e),console.log(r),this.ready((function(){var a=o;console.log("player ready!",a),function(e,o){e.addClass("vjs-livesim")}(a,t.default.mergeOptions(n,e)),a.on("loadstart",(function(){console.log("loadstart! mediainfo: ",a.mediainfo);var e,o,t,n=a.mediainfo||{};c=n.tags&&n.tags.includes(r.featureTag),console.log("_livesimEnabled",c),c?(p=n.duration||0,f=new Date(n.customFields&&(n.customFields.premiere_time||"")),u=new Date(f.getTime()+1e3*p),console.log("_streamDuration",p),console.log("_streamStart",f),console.log("_streamEnd",u),t=u,(e=f)>(o=v)?d=i:e<=o&&t>o?d=l:t<=o?d=s:console.log("Invalid Date set for endTime",t)):console.log("livesim not enabled")})),a.on("loadedmetadata",(function(){console.log("loadedmetadata! setup video");var e=this;switch(d){case 1:console.log("Stream State: PRE"),function(e){var o=document.createElement("p");o.className="vjs-text","preLive"in r&&"message"in r.preLive?o.innerHTML=r.preLive.message:(console.log("No preLive message provided."),o.innerHTML="The performance will go live in: "),e.el().appendChild(o)}(e);break;case 2:console.log("Stream State: LIVE"),g=Math.floor((v-f)/1e3),function(e){console.log("SHOW LIVE CONTROLS"),e.duration(1/0),e.addClass("vjs-live"),function(e,o){void 0===o&&(o=!1);var t=o?"":"none";e.el_.firstChild.style.pointerEvents=t}(e,!1),e.controlBar?(e.controlBar.playToggle.hide(),e.controlBar.progressControl.hide()):console.log("Player does not have expected controlBar.")}(e),function(e){if(e.liveTracker){var o=e.liveTracker.pastSeekEnd_;console.log("Update player timestamp: ",g+o),e.currentTime(g+o)}else console.log("Player does not have expected liveTracker component."),e.currentTime(g)}(e),e.play();break;case 3:console.log("Stream State: POST");break;default:console.log("Stream State: DISABLED")}}))}))};return a("livesim",m),m.VERSION="0.0.0",m}));
