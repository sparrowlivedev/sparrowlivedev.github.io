/*! @name videojs-livesim @version 0.0.0 @license UNLICENSED */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],o):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsLivesim=o(e.videojs)}(this,(function(e){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=o(e),t={},i=n.default.registerPlugin||n.default.plugin,a={},r=!0,l=0,s=0,d=new Date,c=0;function u(e,o){if(!("preLive"in a)||!("showCountdown"in a.preLive)||"preLive"in a&&"showCountdown"in a.preLive&&!a.preLive.showCountdown)console.log("showCountdown disabled");else{var n=document.createElement("div");n.className="vjs-countdown-overlay";var t=document.createElement("div");t.className="vjs-countdown-label";var i=document.createElement("div");if(i.className="vjs-countdown-value","message"in a.preLive){t.innerHTML=a.preLive.message;var r=setInterval((function(){--o<=0?(clearInterval(r),e.el().removeChild(e.el().lastChild),m(e)):i.innerHTML=function(e){e=Number(e);var o=Math.floor(e/86400),n=Math.floor(e%86400/3600),t=Math.floor(e%3600/60),i=Math.floor(e%60);return(o>0?o+(1==o?"  day  ":"  days  "):"")+(o>0||n>0?n+(1==n?"  hour  ":"  hours  "):"")+(o+n>0||t>0?t+(1==t?"  minute  ":"  minutes  "):"")+(o+n+t>0||i>=0?i+(1==i?"  second":"  seconds"):"")}(o)}),1e3)}else console.log("No preLive message provided."),t.innerHTML="The performance will go live in the future.";n.appendChild(t),n.appendChild(i),e.el().appendChild(n)}}function v(e,o){void 0===o&&(o=!1);var n=o?"":"none";e.el_.style.pointerEvents=n}function f(e,o){void 0===o&&(o=!1);var n=o?"":"none";e.el_.firstChild.style.pointerEvents=n}function p(e,o){void 0===o&&(o=!1),o?e.bigPlayButton.show():e.bigPlayButton.hide()}function m(e){e.duration(1/0);v(e,!0),p(e,!0),e.on("play",(function(){2==l&&(!function(e,o){if(e.liveTracker){var n=e.liveTracker.pastSeekEnd_;e.currentTime(o+n)}else console.log("Player does not have expected liveTracker component."),e.currentTime(o)}(e,16),e.liveTracker.stopTracking(),function(e){e.addClass("vjs-live"),f(e,!1),e.controlBar?(e.controlBar.playToggle.hide(),e.controlBar.progressControl.hide()):console.log("Player does not have expected controlBar.")}(e),p(e,!1))})),e.on("ended",(function(){2==l&&function(e){l=3,console.log("Stream ended! Resetting for VOD"),e.load()}(e)})),e.play()}var g=function(e){var o=this;!function(e){"object"==typeof e?(a.preLive=e.preLive,a.featureTag=e.featureTag,a.postLive=e.postLive):a.preLive={message:"Live in: ",showCountdown:1}}(e),this.ready((function(){var i,g=o;i=g,n.default.mergeOptions(t,e),i.addClass("vjs-livesim"),g.on("loadstart",(function(){var e=g.mediainfo||{};f(g,!1),v(g,!1),p(g,!1),e.tags&&e.tags.includes(a.featureTag),c=e.duration||0,s=new Date(e.customFields&&(e.customFields.premiere_time||"")),s=new Date(d.getTime()+3e3),c=120,new Date(s.getTime()+1e3*c)})),g.on("loadedmetadata",(function(){r&&(l=2),function(e,o){switch(o){case 1:console.log("Stream State: PRE"),f(e,!1),v(e,!1),p(e,!1);var n=(s-d.getTime())/1e3;console.log("showCountdown",n),u(e,n);break;case 2:console.log("Stream State: LIVE"),m(e);break;case 3:console.log("Stream State: POST"),f(e,!0),v(e,!0),p(e,!0);break;default:console.log("Stream State: DISABLED")}}(g,l),r=!1}))}))};return i("livesim",g),g.VERSION="0.0.0",g}));
