/*! @name videojs-livesim @version 0.0.0 @license UNLICENSED */
!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],o):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsLivesim=o(e.videojs)}(this,(function(e){"use strict";function o(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var t=o(e),a={},l=t.default.registerPlugin||t.default.plugin,n=1,s=2,i=3,r={},d=!1,c=0,g=0,u=0,f=new Date,p=0,m=0;var v=function(e){var o=this;!function(e){"object"==typeof e?(r.displayText=e.displayText,r.preLive=e.preLive,r.featureTag=e.featureTag,r.postLive=e.postLive):console.log("Options object is not a proper Javscript object {} (JSON).")}(e),console.log(r),this.ready((function(){var l=o;console.log("player ready!",l),function(e,o){e.addClass("vjs-livesim");var t=document.createElement("p");t.className="vjs-text",t.innerHTML="displayText"in o?o.displayText:"Default placeholder text",e.el().appendChild(t)}(l,t.default.mergeOptions(a,e)),l.on("loadstart",(function(){console.log("loadstart! mediainfo: ",l.mediainfo);var e,o,t,a=l.mediainfo||{};d=a.tags&&a.tags.includes(r.featureTag),console.log("_livesimEnabled",d),d?(p=a.duration||0,g=new Date(a.customFields&&(a.customFields.premiere_time||"")),u=new Date(g.getTime()+1e3*p),console.log("_streamDuration",p),console.log("_streamStart",g),console.log("_streamEnd",u),console.log("_pageloadDateTime",f),e=g,o=f,t=u,console.log("setStreamState"),e>o?c=n:e<=o&&t>o?c=s:t<=o?c=i:console.log("Invalid Date set for endTime",t),console.log("_streamState",c)):console.log("livesim not enabled")})),l.on("loadedmetadata",(function(){switch(console.log("loadedmetadata! setup video"),c){case 1:console.log("Stream State: PRE");break;case 2:console.log("Stream State: LIVE"),m=Math.floor((f-g)/1e3),console.log("_pageloadVideoTime",m),function(e){console.log("SHOW LIVE CONTROLS"),e.duration(1/0),e.addClass("vjs-live"),e.controlBar?(e.controlBar.playToggle.hide(),e.controlBar.progressControl.hide()):console.log("Player does not have expected controlBar.")}(l),function(e){if(console.log("UPDATEING PLAYER TIME"),e.liveTracker){var o=e.liveTracker.pastSeekEnd_;return console.log("Timestamp: ",m+o),m+o}console.log("Player does not have expected liveTracker component.")}(l),l.play();break;case 3:console.log("Stream State: POST");break;default:console.log("Stream State: DISABLED")}}))}))};return l("livesim",v),v.VERSION="0.0.0",v}));
